#! /usr/local/bin/csi -ss

(import (lsp-server private)
        (scheme process-context))

(define (main args)
  (define command-port-num (string->number (car args)))
  (define lsp-port-num (string->number (cadr args)))

  (let-values (((inp outp) ($tcp-connect "127.0.0.1"
                                         command-port-num)))
    (write-log 'info
               (format "requesting new LSP connection at port ~a"
                       lsp-port-num))
    (display (format "spawn-lsp-server ~a" lsp-port-num)
             outp)
    (flush-output-port outp)
    (write-log 'info
               (format "LSP connection successfull. Idleing."))
    (read-char)))


